{"version":3,"file":"editIntent.js","sources":["../../src/csm/editIntent.ts"],"sourcesContent":["import {\n  ContentSourceMapDocument,\n  ContentSourceMapDocuments,\n} from '@sanity/client'\n\nimport { parseNormalisedJsonPath } from './jsonpath'\nimport type { PathSegment, StudioUrl } from './types'\n\n/** @alpha */\nexport type EditLink = `/intent/edit/id=${string};path=${string}`\n\n/** @alpha */\nexport interface EditLinkProps {\n  studioUrl: StudioUrl\n  document: ContentSourceMapDocument\n}\n\n/** @alpha */\nexport type DefineEditLink = (\n  studioUrl: StudioUrl,\n) => (\n  sourceDocument: ContentSourceMapDocuments[number],\n) => `${StudioUrl}${EditLink}`\n\n/** @alpha */\nexport function defineEditLink(\n  _studioUrl: StudioUrl,\n): (\n  sourceDocument: ContentSourceMapDocuments[number],\n  path: string | PathSegment[],\n) => string {\n  const studioUrl = _studioUrl.replace(/\\/$/, '')\n  return (sourceDocument, path) =>\n    `${studioUrl}/intent/edit/id=${\n      sourceDocument._id\n    };path=${encodeJsonPathToUriComponent(path)}`\n}\n\n/** @alpha */\nexport function encodeJsonPathToUriComponent(\n  path: string | PathSegment[],\n): string {\n  const sourcePath = Array.isArray(path) ? path : parseNormalisedJsonPath(path)\n  return encodeURIComponent(\n    sourcePath\n      .map((key, i) =>\n        // eslint-disable-next-line no-nested-ternary\n        typeof key === 'number' ? `[${key}]` : i > 0 ? `.${key}` : key,\n      )\n      .join(''),\n  )\n}\n"],"names":["defineEditLink","_studioUrl","studioUrl","replace","sourceDocument","path","concat","_id","encodeJsonPathToUriComponent","sourcePath","Array","isArray","parseNormalisedJsonPath","encodeURIComponent","map","key","i","join"],"mappings":";AAyBO,SAASA,eACdC,UAIU,EAAA;EACV,MAAMC,SAAY,GAAAD,UAAA,CAAWE,OAAQ,CAAA,KAAA,EAAO,EAAE,CAAA;EACvC,OAAA,CAACC,cAAgB,EAAAC,IAAA,KACtB,EAAG,CAAAC,MAAA,CAAAJ,SAAA,EAAS,oBACVI,MAAe,CAAAF,cAAA,CAAAG,GAAA,EACjB,QAAS,CAAA,CAAAD,MAAA,CAAAE,4BAAA,CAA6BH,IAAI,CAAA,CAAA;AAC9C;AAGO,SAASG,6BACdH,IACQ,EAAA;EACR,MAAMI,aAAaC,KAAM,CAAAC,OAAA,CAAQN,IAAI,CAAI,GAAAA,IAAA,GAAOO,wBAAwBP,IAAI,CAAA;EACrE,OAAAQ,kBAAA,CACLJ,UACG,CAAAK,GAAA,CAAI,CAACC,GAAK,EAAAC,CAAA;EAAA;EAET,OAAOD,QAAQ,QAAW,GAAA,GAAA,CAAIT,YAAG,GAAM,CAAA,GAAAU,CAAA,GAAI,CAAI,GAAA,GAAA,CAAIV,MAAQ,CAAAS,GAAA,CAAA,GAAAA,GAAA,CAC7D,CACCE,KAAK,EAAE,CAAA,CACZ;AACF;"}